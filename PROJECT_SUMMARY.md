# Modbus CLI Tool - 项目总结

本项目是一个基于 Rust 编写的命令行 Modbus RTU 通信工具，使用了 tokio-serial 库来实现串口通信。

## 主要功能

### 1. 列出所有端口和信息
- 使用 `tokio_serial::available_ports()` 函数
- 显示端口名称、类型、制造商等详细信息
- 支持 USB、蓝牙、PCI 等不同类型的端口

### 2. 读取指定端口和从站的数据位范围
- 支持完整的串口参数配置（波特率、数据位、停止位、校验位）
- 读取 Modbus 保持寄存器数据
- 数据以十六进制格式展示
- 提供多种显示格式：详细表格和传统十六进制转储

## 技术特点

- **异步编程**: 使用 tokio 运行时提供高性能异步 I/O
- **类型安全**: Rust 的类型系统确保内存安全和线程安全
- **错误处理**: 完善的错误处理和用户友好的错误信息
- **跨平台**: 支持 Windows、Linux 和 macOS

## 依赖库

- `tokio`: 异步运行时
- `tokio-serial`: 串口通信
- `tokio-modbus`: Modbus 协议实现
- `clap`: 命令行参数解析
- `anyhow`: 错误处理

## 使用示例

```bash
# 列出所有可用串口
modbus-cli list-ports

# 读取 10 个寄存器
modbus-cli read -p COM1 -s 1 -a 0 -c 10

# 使用自定义串口设置
modbus-cli read -p COM1 -b 19200 --parity even -s 1 -a 100 -c 5
```

## 输出格式

工具提供两种数据显示格式：

1. **详细表格格式**：
   - 地址（十进制和十六进制）
   - 数值（十进制和十六进制）
   - 二进制表示

2. **十六进制转储格式**：
   - 传统的十六进制转储视图
   - ASCII 字符表示

## 错误处理

- 串口连接错误
- Modbus 通信异常
- 参数验证错误
- 提供详细的错误说明和解决建议

这个工具完全满足了您的需求，提供了完整的 Modbus RTU 串口通信功能，并且具有良好的可扩展性。